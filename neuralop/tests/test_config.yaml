default: &DEFAULT

  #General
  verbose: True
  arch: 'tfno2d'

  # FNO related
  tfno2d:
    data_channels: 3
    n_modes_height: 64
    n_modes_width: 64
    hidden_channels: 64
    out_channels: 1
    lifting_channels: 256
    projection_channels: 256
    incremental_n_modes: None
    n_layers: 4
    domain_padding: None #0.078125
    domain_padding_mode: 'one-sided'
    fft_norm: 'forward'
    norm: 'group_norm'
    skip: 'linear'
    half_prec_fourier: False
    half_prec_inverse: True
    stabilizer: None

    use_mlp: 1
    mlp:
        expansion: 0.5
        dropout: 0

    separable: 0
    preactivation: 0
    factorization: 'cp' #'cp' in best
    joint_factorization: 0
    rank: 0.05
    fixed_rank_modes: False
    implementation: 'factorized'


  data:
    batch_size: 32
    n_train: 32
    size: 128

  # Optimizer
  opt:
    n_epochs: 500
    learning_rate: 1e-3
    training_loss: 'h1'
    weight_decay: 1e-4
    amp_autocast: True

    scheduler_T_max: 500 # For cosine only, typically take n_epochs
    scheduler_patience: 5 # For ReduceLROnPlateau only
    scheduler: 'StepLR' # Or 'CosineAnnealingLR' OR 'ReduceLROnPlateau'
    step_size: 100
    gamma: 0.5

  # Patching
  patching:
    levels: 0
    padding: 0 #.1
    stitching: True
